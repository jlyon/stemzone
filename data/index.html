<!DOCTYPE html>
<html>
    <head>
        <meta content="text/html; charset=utf-8" http-equiv="content-type">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, maximum-scale=1" />

        <title>What's your Stemzone I.Q.?</title>

        <link href="css/reset.css" media="screen" rel="stylesheet" type="text/css">
        <link href="css/slickQuiz.css" media="screen" rel="stylesheet" type="text/css">
        <link href="css/stemzone.css" media="screen" rel="stylesheet" type="text/css">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
        <!--<link href="css/master.css" media="screen" rel="stylesheet" type="text/css">-->
    </head>

    <body id="slickQuiz" class="front">

    <textarea id="in"></textarea>

    <button value="Submit" id="submit">Submit</button><br/>

    <textarea id="out"></textarea>

    <script type="text/javascript">
    jQuery('#submit').bind('click', function() {
        var data = JSON.parse(jQuery('#in').val());
        var out = legend();
        jQuery.each(data, function(i, item) {
            out += "\r\n" + json2csv(item);
        });
        jQuery('#out').val(out);
    });

    function json2csv(item) {
        var csv = [
            item.device,
            item.action,
            item.start,
            item.end,
            item.time,
            item.totalQuestions,
            item.totalAnswered,
            item.correct,
            item.incorrect,
        ];
        for (i=1; i<=20; i++) {
            if (item[i] != undefined) {
                csv.push(item[i]);
            }
            else {
                csv.push('');
            }
        }
        console.log(csv);
        return csv.join(',');
    }

    function legend() {
        var data = [
            'device',
            'action',
            'start',
            'end',
            'time',
            'totalQuestions',
            'totalAnswered',
            'correct',
            'incorrect'
        ];
        for (i=1; i<=20; i++) {
            data.push(i);
        }
        return data.join(',');
    }
    </script>
       
    </body>
</html>
